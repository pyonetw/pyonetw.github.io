<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
    <meta charset="utf-8">
    <title>第四週練習：報童問題之預期利潤</title>
    <link rel="icon" href="/favicon.png">
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="stylesheet" href="/static/bootstrap.min.css">
    <link rel="stylesheet" href="/static/vice.css?250715">
</head>
<body>
    <div class="container">
        <h1 class="my-3">第四週練習：報童問題之預期利潤</h1>

        <h2>題目來源</h2>
        <p class="text-danger">台大資管系孔令傑教授</p>

        <h2>題目敘述</h2>
        <p>你經營一家報攤專賣一份日報，今天下午你得在報社關門前下訂單，告訴報社你要為明天訂購幾份報紙，隔天清晨你就會收到訂購的報紙並且付款。每份報紙的進貨價格是 \(c\) 元，賣給客人的零售價則是 \(r\) 元。每天會來多少個客人想買報紙是件不確定的事，也就是說單日需求量 \(D\) 是隨機的。根據過往經驗，你估計明天的單日需求量會落在 \(0\) 和 \(N\) 之間，並且符合如下的機率分佈：</p>

        <p>\(Pr(D=i)=pi, i=0,1,...,N\)</p>

        <p>意思是說，有 0 個人來買報紙的機率是 \(p_{0}\)、有 1 個人來買報紙的機率是 \(p_{1}\)，依此類推，最後是賣出 \(N\) 份報紙的機率是 \(p_{N}\) ​    。你想要決定你的訂貨量 \(q^{*}\) 去最大化你的期望利潤（expected profit）</p>

        <p>\(\pi(q)=r\mathbb{E}[min\{q,D\}]-cq\)</p>

        <p>其中 \(min\{q,D\}\) 是明天的銷售量（訂貨量和需求量中比較小的那個數字）、\(\mathbb{E}[min\{q,D\}]\) 是預期銷售量（也就是銷售量取期望值）、\(r\mathbb{E}[min\{q,D\}]\) 是預期銷售收益、\(cq\) 則是必須付給報社的進貨成本。這是一個作業管理（operations management）領域的經典存貨問題（inventory problem），因為是很多存貨管理方法的基礎，被特別給予一個名稱叫「報童問題」（newsvendor problem）。</p>

        <p>以下我們用一個例子來說明報童問題。假設進貨成本 \(c=2\)、零售價格 \(r=10\)，而且明天的單日需求量 \(D\) 符合如下的機率分佈：</p>

        <table style="width: 300px;">
            <thead>
                <tr>
                    <th>\(i\)</th>
                    <th>\(Pr(D=x_{i})\)</th>
                </tr>
            </thead>
            <tbody>
                <tr> <td>0</td> <td>0.06</td> </tr>
                <tr> <td>1</td> <td>0.15</td> </tr>
                <tr> <td>2</td> <td>0.22</td> </tr>
                <tr> <td>3</td> <td>0.22</td> </tr>
                <tr> <td>4</td> <td>0.17</td> </tr>
                <tr> <td>5</td> <td>0.10</td> </tr>
                <tr> <td>6</td> <td>0.05</td> </tr>
                <tr> <td>7</td> <td>0.02</td> </tr>
                <tr> <td>8</td> <td>0.01</td> </tr>
            </tbody>
        </table>

        <p>也就是說有 \(6\%\) 的機率沒有任何人想買報紙、\(15\%\) 的機率有一個人想要買，依此類推。你有九個可能的訂貨量（其實有無限多個，不過你應該不會想訂超過八份報紙吧？），讓我們來分析其中幾個：</p>

        <ol>
            <li>如果你不訂貨（\(q=0\)），顯然一份報紙也不會賣掉，零收益零成本，明天一定賺 \(0\) 元。</li>

            <li>如果你訂一份報紙（\(q=1\)），有 \(6\%\) 的機率會賣掉零份（因為沒人想買），這種情況下你會賺 \(0−2=−2\) 元；有 \(94\%\) 的機率會賣掉一份（只要有一個以上的人想買），這種情況下你會賺 \(10−2=8\) 元。你的預期利潤是 \((-2) \times 0.06 + 8 \times 0.94 = 7.4\)元。</li>

            <li>如果你訂兩份報紙（\(q=2\)），有 \(6\%\) 的機率會賣掉零份（因為沒人想買），這種情況下你會賺 \(0−4=−4\) 元；有 \(15\%\) 的機率會賣掉一份（如果恰好有一個人想買），這種情況下你會賺 \(10−4=6\) 元；有 \(79\%\) 的機率會賣掉兩份（只要有兩個以上的人想買），這種情況下你會賺 \(20−4=16\) 元。你的預期利潤是 \((-4) \times 0.06 + 6 \times 0.15 + 16 \times 0.79 = 13.3\) 元</li>
        </ol>

        <p>顯然訂零份或訂一份都不是最好的，因為訂兩份比它們都好。事實上如果你繼續算下去，把 \(q=3,4,...,8\) 都算過一遍，會發現訂四份是最佳策略（\(q^* = 4\)）。當然如果環境改變（\(c\) 和 \(r\) 的值或 \(D\) 的分佈改變），結果就可能會不同。</p>

        <p>在這題中，你將會被給定 \(c\)、\(r\)、\(N\)、\(p_{0}\)、\(p_{1}\) 直到 \(p_{N}\) 的值，以及一個已經被決定的訂貨量 \(q\)。你的任務是計算出此訂貨量 \(q\) 之下能得到的預期利潤 \(\pi(q)\) 無條件捨去到整數位。以上面的例子而言，如果訂貨量是 \(q=6\)，則預期利潤將是 \(17.1\)（請自己試著算算看），因此請輸出 \(17\)。</p>

        <h2>輸入輸出格式</h2>

        <p>在每筆測試資料中，會有 \(N+5\) 列，每一列都有一個數字。第一列的整數是單位進貨成本 \(c\)、第二列的整數是單位零售價格 \(r\)、第三列的整數是需求的可能個數 \(N\)、第四列是訂貨量 \(q\)、第五列開始的小數則依序是賣出零份、一份直到 \(N\) 份報紙的機率（也就是說對於 \(i=4,5,...,N+4\)，第 \(i\) 列記錄的是賣出 \(i−4\) 份報紙的機率）。已知 \(c\) 會落在 \(1\) 到 \(100\) 之間（包含 \(1\) 跟 \(100\)）、\(r\) 會落在 \(1\) 到 \(100\) 之間（包含 \(1\) 跟 \(100\)）、\(r\) 不會比 \(c\) 小、\(N\) 一定會是 \(8\)。此外，對於 \(i=0,1,...,N\)，\(p_{i}\) 會介於 \(0\) 到 \(1\) 之間（包含 \(0\) 跟 \(1\)）、最多只有兩位小數，並且滿足 \(\sum_{i = 0}^N p_{i} = 1\)。</p>

        <p>讀入這些資料之後，你會計算並輸出在給定訂購量下的預期利潤無條件捨去到整數 \(\lfloor \pi(q) \rfloor\)。</p>

        <p class="texti-datain">如果輸入是</p>
        <pre> <code>
2
10
8
6
0.06
0.15
0.22
0.22
0.17
0.1
0.05
0.02
0.01
        </code> </pre>
        <p>則輸出應該是</p>
        <pre> <code>
17
        </code> </pre>
    </div>
</body>
</html>